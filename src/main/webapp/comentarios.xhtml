<?xml version="1.0" encoding="UTF-8"?>
        <!--
        To change this license header, choose License Headers in Project Properties.
        To change this template file, choose Tools | Templates
        and open the template in the editor.
        -->
        <!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
 <h:head>
 <h:outputStylesheet name="primeicons/primeicons.css" library="primefaces"/>
 <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous"/>
 <link href="iniciativas.css" rel="stylesheet" type="text/css"/>
 
 <title>Comentarios</title>
 </h:head>
 <script type = "text/javascript">
	function confirmDelete()
	{
		var opcion = confirm("¿Esta seguro que quiere cerrar sesión?");
        	if (opcion == true) {
            		logeoBean.cerrarSesion();;
    		} else {
    	    		return false;
    		}	
	}
</script>
 <h:body>
 	
		 <style type="text/css">
    .ui-row-editor .ui-row-editor-pencil {
        margin-left:8px;
    }
</style>

	<h:form>     
		<p:growl id="messages" showDetail="true" />
	 
		<p:toolbar>
			<f:facet name="left">
	 			<p:menuitem value="Homepage" action="#{logeoBean.redirect('/faces/administrador.xhtml')}" icon="pi pi-home" />
				<p:menuButton value="Opciones">
					<p:menuitem value="Consultar usuarios" action="#{logeoBean.redirect('/faces/Usuario.xhtml')}"/>
					<p:menuitem value="Registrar iniciativa" action="#{logeoBean.redirect('/faces/registrar_iniciativa.xhtml')}"/>
				</p:menuButton>
				

			</f:facet>
	 
			<f:facet name="right">
				<h:outputText id="out" value="#{AdministradorBean.consultarUsuario(logeoBean.name).nombre}"/>
				<h:outputText id="out2" value="(#{AdministradorBean.consultarUsuario(logeoBean.name).rol}) "/>
				<p:commandButton value="Salir" onclick="confirmDelete()" icon="pi pi-sign-out" />
				
			</f:facet>
	 
		</p:toolbar>
	</h:form>


	<h:form>
		<p:growl id="msgs" showDetail="true" skipDetailIfEqualsSummary="true" />
	  
		<p:panel id="custom" header="Iniciativa" style="margin-bottom:20px">
			<h:panelGrid columns="3" cellpadding="10">
					<style type="text/css">
						.ui-panelgrid.showcase-text-align-center .ui-grid-responsive .ui-panelgrid-cell {
							text-align: center;
						}
					 
						.customPanelGrid .ui-panelgrid-content {
							align-items: center;
						}
					</style>
						<p:panelGrid id="informacion" columns="2">
							<f:facet name="header">
								<p:graphicImage library="img" name="/Solucionado.png" />
							</f:facet>
							 
							<h:outputText value="Proponente:" />
							<h:outputText value="#{UserBean.selectedi.getUsuarioProponente()}" />
							 
							<h:outputText value="Contacto:" />
							<h:outputText value="#{UserBean.selectedi.getcorreoProponente()}" />
							 
							<h:outputText value="Fecha de inicio:" />
							<h:outputText value="#{UserBean.selectedi.getFecha()}" /> 
							 
							<h:outputText value="Votos:" />
							<h:outputText value="#{UserBean.selectedi.getVotos()}" />
							 
						</p:panelGrid>
				
						<p><h2><strong>"#{UserBean.selectedi.getNombreIniciativa()}"</strong></h2></p>
                        <p><strong>"#{UserBean.consultarPalabrasClaveIniciativa(7)}"</strong></p>
						<p><h3>Descripción: </h3></p>
						<p>"#{UserBean.selectedi.getDescripcion()}"</p>
						
						<p:selectBooleanButton value="Agregar a favoritos" id="value2" binding="#{valor}" onclick="#{UserBean.consultarIniciativas()}" onIcon="pi pi-star-o" offIcon="pi pi-star" style="width:60px">
							<p:ajax update="custom" click="#{UserBean.setSelectedi(UserBean.selectedi)}" listener="#{UserBean.registrarVoto(logeoBean.name,UserBean.selectedi.id)}" />
						</p:selectBooleanButton>
						
				</h:panelGrid>
	 
			<f:facet name="actions">
				<h:commandLink styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default"><h:outputText styleClass="ui-icon pi pi-question" /></h:commandLink>
				<h:commandLink styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default"><h:outputText styleClass="ui-icon pi pi-star" /></h:commandLink>
			</f:facet>
		</p:panel>
	 
	</h:form>



		
	<h:form id="ConsultaComentarios">
	 
	 <p:growl id="msgss" showDetail="true"/>
         
         <p:dataTable var="comentario" value="#{UserBean.consultarComentariosIniciativa(UserBean.idPag)}" class="tabla"
				paginator="true"  paginatorTemplate="{FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
				rows="8" selectionMode="single" id="id"  tableStyle="table-layout: left;" style="width:50%"
				rowKey="#{comentario.id}" editable="false" >
			
			<f:facet name="header">
				Comentarios.
			</f:facet>
			
			



			<p:column headerText="Id">
				<h:outputText value="#{comentario.getId()}"/>
			</p:column>

			<p:column headerText="Usuario">
				<h:outputText value="#{comentario.getIdUsuario()}"/>
			</p:column>
             
						
			<p:column headerText="Comentario">
				<h:outputText value="#{comentario.getContenido()}"/>
			</p:column>
			
			
			<p:column headerText="Fecha">
				<h:outputText value="#{comentario.getFecha()}"/>
			</p:column>
            

		
				
             
		</p:dataTable>	                 
         
     </h:form>
	 
	 
	<h:form id="RegistrarComentario">              
         
			<p:growl id="msgs" showDetail="true" skipDetailIfEqualsSummary="true" />
				<p:tab id="personal" title="Comentar">
					<p:panel header="Publica tu comentario">
					<p:messages />
						<p>"#{UserBean.selectedi.id}"</p>
						<p:inputTextarea rows="5" cols="40" counter="display" maxlength="140" counterTemplate="Quedan {0} caracteres restantes." autoResize="false" binding="#{contenido}" required="true"/>
						<br />
						<h:outputText id="display" />
								<div class="divButton">
									<p:commandButton  class="Button" update="ConsultaComentarios" actionListener="#{UserBean.insertarComentario(logeoBean.name,UserBean.idPag,contenido.value)}" value="Publicar"/>
	
								</div> 
					</p:panel>
				</p:tab>

                 
				 

     </h:form>
	 
     
    
</h:body>
</html>