<?xml version="1.0" encoding="UTF-8"?>
        <!--
        To change this license header, choose License Headers in Project Properties.
        To change this template file, choose Tools | Templates
        and open the template in the editor.
        -->
        <!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
 <h:head>
 <h:outputStylesheet name="primeicons/primeicons.css" library="primefaces"/>
 <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous"/>
 <link href="iniciativas.css" rel="stylesheet" type="text/css"/>
 
 <title>Comentarios</title>
 </h:head>
 <script type = "text/javascript">
	function confirmDelete()
	{
		var opcion = confirm("¿Esta seguro que quiere cerrar sesión?");
        	if (opcion == true) {
            		return true;
    		} else {
    	    		return false;
    		}	
	}
</script>
 <h:body>
 	
		 <style type="text/css">
    .ui-row-editor .ui-row-editor-pencil {
        margin-left:8px;
    }
</style>

	<h:form>     
		<p:growl id="messages" showDetail="true" />
	 
		<p:toolbar>
			<f:facet name="left">
	 			<p:menuitem value="Homepage" action="#{logeoBean.redirect('/faces/administrador.xhtml')}" icon="pi pi-home" />
				<p:menuButton value="Opciones">
					<p:menuitem value="Consultar usuarios" action="/Usuario.xhtml"/>
					<p:menuitem value="Registrar iniciativa" action="/registrar_iniciativa.xhtml"/>
				</p:menuButton>
				

			</f:facet>
	 
			<f:facet name="right">
				<h:outputText id="out" value="#{AdministradorBean.consultarUsuario(logeoBean.name).nombre}"/>
				<h:outputText id="out2" value="(#{AdministradorBean.consultarUsuario(logeoBean.name).rol}) "/>
				<p:commandButton value="Salir" action="#{logeoBean.cerrarSesion()}" onclick="confirmDelete()" icon="pi pi-sign-out" />
				
			</f:facet>
	 
		</p:toolbar>
	</h:form>


		
	<h:form id="ConsultaComentarios">
	 
	 <p:growl id="msgss" showDetail="true"/>
         
         <p:dataTable var="comentario" value="#{UserBean.consultarComentariosIniciativa(UserBean.idPag)}" class="tabla"
				paginator="true"  paginatorTemplate="{FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
				rows="8" selectionMode="single" id="id"  
				rowKey="#{comentario.id}" editable="true" >
			
			<f:facet name="header">
				Comentarios.
			</f:facet>
			
			



			<p:column headerText="Id">
				<h:outputText value="#{comentario.getId()}"/>
			</p:column>

			<p:column headerText="Usuario">
				<h:outputText value="#{comentario.getIdUsuario()}"/>
			</p:column>
             
						
			<p:column headerText="Comentario">
				<h:outputText value="#{comentario.getContenido()}"/>
			</p:column>
			
			
			<p:column headerText="Fecha">
				<h:outputText value="#{comentario.getFecha()}"/>
			</p:column>
            

			<p:column style="width:35px">
				<p:rowEditor />
			</p:column>
				
             
		</p:dataTable>	                 
         
     </h:form>
	 
	 
	<h:form id="RegistrarComentario">              
         
			<p:growl id="msgs" showDetail="true" skipDetailIfEqualsSummary="true" />
         	<p:wizard flowListener="#{AdministradorBean.onFlowProcess}">
				<p:tab id="personal" title="Comentar">
					<p:panel header="Publica tu comentario">
					<p:messages />
									<p>En este momento se va a hacer un comentario a la iniciativa:  <strong>"#{UserBean.selectedi}"also "#{UserBean.selectedi.id}"</strong>
				</p>
						<p:inputTextarea rows="5" cols="40" counter="display" maxlength="140" counterTemplate="Quedan {0} caracteres restantes." autoResize="false" binding="#{contenido}" required="true"/>
						<br />
						<h:outputText id="display" />
								<div class="divButton">
									<p:commandButton  class="Button" update="ConsultaComentarios" actionListener="#{UserBean.insertarComentario(logeoBean.name,UserBean.idPag,contenido.value)}" value="Publicar"/>
	
								</div> 
					</p:panel>
				</p:tab>


		</p:wizard>					           
                 
				 

     </h:form>
	 
     
    
</h:body>
</html>