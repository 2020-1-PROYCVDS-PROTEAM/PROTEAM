<?xml version="1.0" encoding="UTF-8"?>
        <!--
        To change this license header, choose License Headers in Project Properties.
        To change this template file, choose Tools | Templates
        and open the template in the editor.
        -->
        <!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
 <h:head>
 <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous"/>
 <link href="iniciativas.css" rel="stylesheet" type="text/css"/>
 <title>Consultar iniciativas</title>
 </h:head>
 <h:body>
 	
		 <style type="text/css">
    .ui-row-editor .ui-row-editor-pencil {
        margin-left:8px;
    }
</style>

	<h:form>     
		<p:growl id="messages" showDetail="true" />
	 
		<p:toolbar>
			<f:facet name="left">
	 
				<p:menuButton value="Opciones">
					<p:menuitem value="Consultar usuarios" action="/Usuario.xhtml"/>
					<p:menuitem value="Registrar iniciativa" action="/registrar_iniciativa.xhtml"/>
				</p:menuButton>
				

			</f:facet>
	 
			<f:facet name="right">
				<p:commandButton id="out" type="button" title="#{LogeoBean.name}" />
				<p:menuButton value="Options">
					<p:menuitem value="registro" action="/registro.xhtml" update="messages" icon="pi pi-save" />
					<p:menuitem value="Homepage" action="/administrador.xhtml" icon="pi pi-home" />
					<p:menuitem value="Cerrar sesion" action="#{logeoBean.cerrarSesion()}" icon="pi pi-home" />
				</p:menuButton>
			</f:facet>
	 
		</p:toolbar>
	</h:form>


		
	<h:form id="ConsultaIniciativa">
	 
	 <p:growl id="msgss" showDetail="true"/>
         
         <p:dataTable var="iniciativa" value="#{AdministradorBean.consultarIniciativas()}" class="tabla"
				paginator="true"  paginatorTemplate="{FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
				rows="8" selectionMode="single" id="id"  
				rowKey="#{iniciativa.id}" editable="true" >
			
			<f:facet name="header">
				Iniciativas.
			</f:facet>
			
			
			<p:ajax event="rowEdit" listener="#{AdministradorBean.cambiarEstado(iniciativa.getId(),are.value)}" oncomplete="updateTable()" update="resultado"/>


			<p:column headerText="Id">
				<h:outputText value="#{iniciativa.getId()}"/>
			</p:column>

			<p:column headerText="Votos">
				<h:outputText value="#{iniciativa.getVotos()}"/>
			</p:column>
             
			<p:column headerText="PalabraClave">
				<h:outputText value="#{iniciativa.getPalabraClave()}"/>
			</p:column>
						
			<p:column headerText="Nombre">
				<h:outputText value="#{iniciativa.getNombreIniciativa()}"/>
			</p:column>
			
			
			<p:column headerText="Descripcion">
				<h:outputText value="#{iniciativa.getDescripcion()}"/>
			</p:column>
             
             		<p:column headerText="Area">
				<h:outputText value="#{iniciativa.getArea()}"/>
			</p:column>
             
             		<p:column headerText="Usuario">
				<h:outputText value="#{iniciativa.getUsuarioProponente()}"/>
			</p:column>
             
                         <p:column headerText="CorreoU">
				<h:outputText value="#{iniciativa.getcorreoProponente()}"/>
			</p:column> 
                        
                         <p:column headerText="Fecha">
				<h:outputText value="#{iniciativa.getFecha()}"/>
			</p:column>     


			<p:column headerText="Estado">
            <p:cellEditor>
                <f:facet name="output"><h:outputText id="resultado"  var="x" value="#{iniciativa.estado}" /></f:facet>
                <f:facet name="input" >
                    <h:selectOneMenu binding="#{are}" id="are" value="xa" style="width:100%">
                        <f:selectItems id="xa" value="#{AdministradorBean.ideas}" var="ide" itemLabel="#{ide}"  itemValue="#{ide}" />			
                    </h:selectOneMenu>
                </f:facet>
            </p:cellEditor>
			</p:column>

			<p:column style="width:35px">
				<p:rowEditor />
			</p:column>
				
             
		</p:dataTable>	                 
         
     </h:form>
     
    
</h:body>
</html>